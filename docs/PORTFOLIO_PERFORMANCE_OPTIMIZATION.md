# Redis 캐시를 활용한 API 성능 최적화

## 📋 프로젝트 개요

대규모 동시 요청 환경에서 API 응답 성능을 개선하기 위해 Redis 캐시 시스템을 도입하고, 부하 테스트를 통해 성능 개선 효과를 검증했습니다.

---

## 🎯 목표

- **서버 부하 감소**: 데이터베이스 쿼리 부하를 줄여 서버 리소스 효율성 향상
- **응답 시간 개선**: 사용자 경험 향상을 위한 API 응답 시간 단축
- **확장성 확보**: 높은 트래픽 환경에서도 안정적인 서비스 제공

---

## 🛠️ 구현 내용

### 1. Redis 캐시 시스템 구축

```typescript
// 캐시 전략
- 캐시 키: 사용자별, 팀별 데이터 분리
- TTL: 5분 (데이터 일관성과 성능의 균형)
- 캐시 무효화: 데이터 변경 시 자동 캐시 삭제
```

**주요 기능:**
- 사용자별 팀 목록 캐싱
- 팀 상세 정보 캐싱
- 채널 및 이벤트 목록 캐싱
- 자동 캐시 무효화 (데이터 업데이트 시)

### 2. 캐시 적용 API

- `/api/teams` - 팀 목록 조회
- `/api/teams/[teamId]` - 팀 상세 정보
- `/api/teams/[teamId]/channels` - 채널 목록
- `/api/teams/[teamId]/events` - 이벤트 목록

---

## 📊 성능 개선 결과

### 부하 테스트 환경
- **동시 요청 수**: 50개
- **총 요청 수**: 500개 (5개 API × 100개)
- **테스트 방법**: 동시 요청 부하 테스트

### 핵심 성과: `/api/teams` API

| 지표 | 캐시 미사용 | 캐시 사용 | 개선율 |
|------|------------|----------|--------|
| **서버 처리 시간** | 606.82ms | 262.50ms | **↓ 56.7%** |
| **처리량 (Throughput)** | 81.20 req/s | 93.01 req/s | **↑ 14.5%** |
| **평균 응답 시간** | 951.60ms | 752.21ms | **↓ 21.0%** |
| **최소 응답 시간** | 535.44ms | 207.74ms | **↓ 61.2%** |

### 전체 API 성능 개선

#### 서버 처리 시간 개선 (DB 쿼리 감소)

| API | 개선율 |
|-----|--------|
| `/api/teams` | **↓ 56.7%** |
| `/api/teams/[teamId]/channels` | **↓ 57.6%** |
| `/api/teams/[teamId]/events` | **↓ 52.4%** |
| `/api/teams/[teamId]` | ↓ 39.9% |

**평균 서버 처리 시간 개선: 약 50% 감소**

---

## 💡 기술적 성과

### 1. 데이터베이스 부하 감소
- **캐시 히트율 향상**: 반복 조회 시 DB 쿼리 대신 Redis에서 조회
- **서버 리소스 절약**: CPU 및 메모리 사용량 감소
- **확장성 향상**: 더 많은 동시 사용자 지원 가능

### 2. 사용자 경험 개선
- **응답 시간 단축**: 평균 20% 이상 응답 시간 감소
- **일관된 성능**: 높은 부하 상황에서도 안정적인 응답 시간 유지
- **처리량 증가**: 초당 처리 가능한 요청 수 증가

### 3. 시스템 안정성 향상
- **DB 연결 풀 부담 감소**: 불필요한 DB 쿼리 제거
- **서버 부하 분산**: Redis를 통한 부하 분산
- **장애 복구 능력**: 캐시 미스 시 자동으로 DB 조회로 폴백

---

## 🔧 구현 세부사항

### 캐시 전략

```typescript
// 캐시 키 구조
cache:teams:{userId}              // 사용자별 팀 목록
cache:team:{teamId}:{userId}       // 팀 상세 정보
cache:team-channels:{teamId}       // 채널 목록
cache:team-events:{teamId}:{userId} // 이벤트 목록

// 캐시 무효화 전략
- 팀 생성/수정/삭제 시 → 관련 캐시 자동 삭제
- 채널 생성 시 → 채널 목록 캐시 삭제
- 이벤트 생성 시 → 이벤트 목록 캐시 삭제
```

### 에러 처리 및 폴백

```typescript
// Redis 연결 실패 시 자동 폴백
- Redis 미사용 시: DB 직접 조회
- 캐시 미스 시: DB 조회 후 캐시 저장
- 네트워크 오류 시: 자동 재시도 (최대 3회)
```

---

## 📈 성능 측정 방법론

### 부하 테스트 도구 개발
- **자체 개발 부하 테스트 스크립트**
- 동시 요청 처리량 측정
- 응답 시간 분포 분석 (평균, 중간값, 95%, 99% 백분위수)
- 서버 측 처리 시간 추적

### 측정 지표
- **Throughput (처리량)**: 초당 처리 가능한 요청 수
- **Latency (응답 시간)**: 클라이언트 측 응답 시간
- **Server Time**: 서버 측 실제 처리 시간
- **Success Rate**: 요청 성공률

---

## 🎓 학습 및 개선 사항

### 1. 캐시 전략 최적화
- **TTL 조정**: 데이터 특성에 따른 적절한 캐시 유지 시간 설정
- **캐시 키 설계**: 사용자별, 팀별 데이터 분리로 캐시 효율성 향상
- **캐시 워밍업**: 자주 조회되는 데이터 사전 로드

### 2. 모니터링 및 분석
- **캐시 히트율 추적**: 서버 로그를 통한 캐시 사용률 모니터링
- **성능 지표 수집**: 지속적인 성능 모니터링을 통한 최적화

### 3. 확장 가능성
- **캐시 클러스터링**: 향후 대규모 트래픽 대비 Redis 클러스터 구성 가능
- **캐시 계층화**: L1(메모리) + L2(Redis) 다층 캐시 구조 확장 가능

---

## 🏆 프로젝트 성과 요약

### 정량적 성과
- ✅ **서버 처리 시간 평균 50% 감소**
- ✅ **처리량 14.5% 증가** (주요 API 기준)
- ✅ **응답 시간 평균 20% 이상 개선**
- ✅ **데이터베이스 쿼리 부하 대폭 감소**

### 정성적 성과
- ✅ **시스템 확장성 향상**: 더 많은 동시 사용자 지원 가능
- ✅ **서버 리소스 효율성 개선**: CPU 및 메모리 사용량 감소
- ✅ **사용자 경험 향상**: 빠르고 일관된 응답 시간 제공
- ✅ **운영 비용 절감**: 서버 리소스 사용량 감소로 인프라 비용 절감 가능

---

## 🛠️ 사용 기술

- **Backend**: Node.js, Next.js
- **Database**: PostgreSQL (Prisma ORM)
- **Cache**: Redis (ioredis)
- **Testing**: 자체 개발 부하 테스트 도구
- **Monitoring**: 서버 로그 기반 성능 추적

---

## 📝 결론

Redis 캐시 시스템 도입을 통해 **서버 처리 시간을 평균 50% 감소**시키고, **처리량을 14.5% 향상**시켰습니다. 이를 통해 시스템의 확장성과 안정성을 크게 개선했으며, 사용자에게 더 나은 경험을 제공할 수 있게 되었습니다.

**핵심 성과**: 대규모 동시 요청 환경에서도 안정적이고 빠른 API 응답을 보장하는 캐시 시스템을 구축했습니다.

---

*이 프로젝트는 실제 운영 환경에서의 성능 개선을 목표로 진행되었으며, 부하 테스트를 통해 검증된 결과입니다.*


